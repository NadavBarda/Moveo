<mat-card class="register-card">
    <h2>Register</h2>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <app-cancel-auto-fill></app-cancel-auto-fill>


        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Full Name</mat-label>
            <input matInput formControlName="name" />
            @if (registerForm.get('name')?.invalid && registerForm.get('name')?.touched) {
            <div class="error">
                @if (registerForm.get('name')?.errors?.['required']) {
                <small>Name is required.</small>
                }
            </div>
            }
        </mat-form-field>


        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput formControlName="email" autocomplete="email" />
            @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
            <div class="error">
                @if (registerForm.get('email')?.errors?.['required']) {
                <small>Email is required.</small>
                }
                @if (registerForm.get('email')?.errors?.['email']) {
                <small>Not valid Email</small>
                }
            </div>
            }
        </mat-form-field>



        <mat-form-field appearance="outline" class="full-width dense">
            <mat-label>Password</mat-label>
            <input matInput [type]="hide() ? 'password' : 'text'" formControlName="password" />

            <button mat-icon-button matSuffix type="button" (click)="hide.set(!hide())"
                [attr.aria-label]="hide() ? 'Show password' : 'Hide password'" [attr.aria-pressed]="!hide()">
                <mat-icon>{{ hide() ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>

            @if (registerForm.get('password')?.touched && registerForm.get('password')?.invalid) {
            <mat-error *ngIf="registerForm.get('password')?.hasError('required')">
                Password is required.
            </mat-error>
            <mat-error *ngIf="registerForm.get('password')?.hasError('length')">
                Password must be at least 6 characters long.
            </mat-error>
            <mat-error *ngIf="registerForm.get('password')?.hasError('passwordPattern')">
                Password must contain both letters and numbers.
            </mat-error>
            }
        </mat-form-field>


        <input type="date" formControlName="birthDate" />
        <app-address-field [addressForm]="addressForm"></app-address-field>

        <button mat-raised-button color="primary" class="full-width" type="submit">
            Register
        </button>

        @if (message()) {
        <p class="message">{{ message() }}</p>
        }

        <p class="login-link">
            Already have an account?
            <a routerLink="/login">Login here</a>
        </p>
    </form>
</mat-card>